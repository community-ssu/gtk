.\"Generated by db2man.xsl. Don't modify this, modify the source.
.de Sh \" Subsection
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Ip \" List item
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.TH "APT-FTPARCHIVE" 1 "29 Février 2004" "Linux" ""
.SH NAME
apt-ftparchive \- Un outil pour créer des index
.SH "SYNOPSIS"
.ad l
.hy 0
.HP 15
\fBapt\-ftparchive\fR [\fB\-hvdsq\fR] [\fB\-\-md5\fR] [\fB\-\-delink\fR] [\fB\-\-readonly\fR] [\fB\-\-contents\fR] [\fB\-o=\fIoption\ de\ configuration\fR\fR] [\fB\-c=\fIfichier\fR\fR] {\fBpackages\ \fIchemin\fR...\ [\fIoverride\fR\ [\fIpréfixe\-de\-chemin\fR]]\fR | \fBsources\ \fIchemin\fR...\ [\fIoverride\fR\ [\fIpréfixe\-de\-chemin\fR]]\fR | \fBcontents\ \fIchemin\fR\fR | \fBrelease\ \fIchemin\fR\fR | \fBgenerate\ \fIfichier\-de\-configuration\fR\ \fIsection\fR...\fR | \fBclean\ \fIfichier\-de\-configuration\fR\fR}
.ad
.hy

.SH "DESCRIPTION"

.PP
 \fBapt\-ftparchive\fR est l'outil en ligne de commande qui crée les index dont APT se sert pour accéder aux sources des distributions\&. Un index doit être créé pour un site et basé sur le contenu de ce site\&.

.PP
\fBapt\-ftparchive\fR est un ensemble comprenant le programme \fB\fBdpkg\-scanpackages\fR\fR(8)   et toutes ses fonctionnalités via la commande packages\~; il comprend aussi un générateur de fichier «\~Contents\~», la commande contents, et une technique élaborée pour «\~scripter\~» le processus de création d'une archive complète\&.

.PP
 \fBApt\-ftparchive\fR peut utiliser lui\-même des bases de données binaires pour «\~cacher\~» le contenu d'un fichier \&.deb\~; il n'a pas besoin de programmes extérieurs, sauf \fB\fBgzip\fR\fR(1) \&. Lors d'une exécution, il vérifie les changements dans les fichiers et crée les fichiers compressés voulus\&.

.PP
À moins que l'option \fB\-h\fR ou \fB\-\-help\fR ne soit donnée, l'une des commandes suivantes doit être présente\~: 

.TP
packages
La commande packages crée un fichier «\~Packages\~» à partir d'une arborescence\&. Elle recherche récursivement à travers le répertoire donné les fichiers \&.deb et, pour chaque fichier trouvé, envoie une entrée pour ce paquet sur la sortie standard\&. Cette commande est approximativement équivalente à \fB\fBdpkg\-scanpackages\fR\fR(8) \&.

On peut se servir de l'option \fB\-\-db\fR pour demander un cache binaire\&.

.TP
sources
La commande sources crée un index des sources à partir d'une arborescence\&. Elle recherche récursivement à travers le répertoire donné les fichiers \&.dsc et, pour chaque fichier trouvé, envoie une entrée pour ce paquet sur la sortie standard\&. Cette commande est approximativement équivalente à \fB\fBdpkg\-scansources\fR\fR(8) \&.

Quand on précise un fichier «\~override\~», c'est un fichier source avec une extension \&.src qui est recherché\&. On peut se servir de l'option \fB\-\-source\-override\fR pour changer de fichier source d'«\~override\~»\&.

.TP
contents
La commande contents crée un fichier «\~Contents\~» à partir d'une arborescence\&. Elle recherche récursivement à travers le répertoire donné les fichiers \&.deb et, pour chaque fichier trouvé, lit la liste des fichiers\&. Elle trie la liste des fichiers correspondant à des paquets et l'envoie sur la sortie standard\&. Les répertoires ne font pas partie du résultat\&. Quand un fichier appartient à plusieurs paquets, une virgule sépare les paquets\&.

On peut se servir de l'option \fB\-\-db\fR pour demander un cache binaire\&.

.TP
release
La commande release crée un fichier Releases à partir d'un répertoire\&. Elle cherche récursivement dans ce répertoire les fichiers Packages, Packages\&.gz, Packages\&.bz2, Sources, Sources\&.gz, Sources\&.bz2, Release et md5sum\&.txt\&. Elle envoie alors un fichier Release sur la sortie standard avec un résumé MD5 et un résumé SHA1 pour chaque fichier\&.

La valeur des autres champs du fichier Release est tirée de la valeur correspondante dans APT::FTPArchive::Release, p\&. ex\&. APT::FTPArchive::Release::Origin\&. Les champs reconnus sont : Origin, Label, Suite, Version, Codename, Date, Architectures, Components, Description\&.

.TP
generate
La commande generate est conçue pour être exécutable par le programme cron et elle crée un index en suivant le fichier de configuration donné\&. Le langage de configuration fournit un moyen souple de préciser index et répertoires aussi bien que les paramètres requis\&.

.TP
clean
La commande clean range les bases de données utilisées par le fichier de configuration en supprimant les enregistrements qui ne sont plus nécessaires\&.
 

.SH "CONFIGURATION DE LA COMMANDE GENERATE"

.PP
La commande generate utilise un fichier de configuration pour décrire l'archive qui va être créée\&. Le format de ce fichier est le format ISC classique utilisé par des outils ISC comme bind 8 et dhcpd\&. Le fichier \fB\fIapt\&.conf\fR\fR(5)   décrit ce format\&. Il faut noter que l'analyse de ce fichier se fait par section tandis que celle d'\fB\fIapt\&.conf\fR\fR(5)  se fait par arborescence\&. Cela n'affecte que l'usage de l'étiquette de visée (scope tag)\&.

.PP
Ce fichier de configuration possède quatre sections, décrites ci\-dessous\&.

.SS "La section Dir"

.PP
La section Dir définit les répertoires standards où situer les fichiers nécessaires au processus de création\&. Ces répertoires sont précédés de chemins relatifs définis dans les sections suivantes de manière à produire un chemin absolu et complet\&.

.TP
ArchiveDir
Indique la racine de l'archive FTP\~; Pour une configuration Debian classique, c'est le répertoire qui contient le fichier \fIls\-LR\fR et les noeuds des distributions\&.

.TP
OverrideDir
Indique l'emplacement des fichiers d'«\~override\~»\&.

.TP
CacheDir
Indique l'emplacement des fichiers de cache\&.

.TP
FileListDir
Indique l'emplacement des fichiers contenant la liste des fichiers (si on se sert de la valeur FileList définie plus bas)\&.

.SS "La section Default"

.PP
La section Default précise les valeurs par défaut et les paramètres qui contrôlent la marche du générateur\&. Ces valeurs peuvent être annulées dans d'autres sections (paramètrage par section)\&.

.TP
Packages::Compress
Indique comment sont compressés les fichiers d'index\&. C'est une chaîne qui contient des valeurs séparées par des espaces\~; elle contient au moins l'une des valeurs suivantes\~: «\~\&.\~» (pas de compression), «\~gzip\~», «\~bzip2\~»\&. Par défaut, c'est la chaîne «\~\&. gzip\~»\&.

.TP
Packages::Extensions
Indique la liste par défaut des extensions de fichier qui constituent des paquets\&. Par défaut, c'est «\~\&.deb\~»\&.

.TP
Sources::Compress
Identique à Packages::Compress mais précise comment sont compressés les fichiers sources\&.

.TP
Sources::Extensions
Indique la liste par défaut des extensions de fichier qui constituent des fichiers sources\&. Par défaut, c'est «\~\&.dsc\~»\&.

.TP
Contents::Compress
Identique à Packages::Compress mais précise comment sont compressés les fichiers «\~Contents\~»\&.

.TP
DeLinkLimit
Indique le nombre de kilooctets à délier (et à remplacer par des liens en dur) pour chaque exécution\&. On s'en sert, pour chaque section, avec le paramètre External\-Links\&.

.TP
FileMode
Indique le système de permissions des fichiers d'index créés\&. Par défaut, c'est le mode 0644\&. Tous les fichiers d'index ont ce mode et le masque utilisateur (umasq) est ignoré\&.

.SS "La section TreeDefault"

.PP
On indique les valeurs par défaut particulières à la section Tree\&. Toutes ces variables sont des variables de substitution\~; les chaînes $(DIST), $(SECTION) et $(ARCH) sont remplacées par leur valeur respective\&.

.TP
MaxContentsChange
Indique le nombre de kilooctets de fichiers «\~Contents\~» qui sont créés chaque jour\&. Les fichiers «\~Contents\~» sont tirés au sort selon le système \fIround\-robin\fR de manière que, sur plusieurs jours, tous soient reconstruits\&.

.TP
ContentsAge
Contrôle le nombre de jours pendant lequel un fichier «\~Contents\~» peut être utilisé sans actualisation\&. Quand cette limite est franchie, le «\~mtime\~» du fichier «\~Contents\~» est mis à jour\&. Cela peut arriver quand un fichier est modifié sans que cela modifie le fichier «\~Contents\~» (modification par «\~override\~» par exemple)\&. Un délai est permis dans l'espoir que de nouveaux «\~\&.deb\~» seront installés, exigeant un nouveau «\~Contents\~»\&. Par défaut ce nombre vaut 10, l'unité étant le jour\&.

.TP
Directory
Indique la racine de l'arborescence des «\~\&.deb\~»\&. Par défaut, c'est \fI$(DIST)/$(SECTION)/binary\-$(ARCH)/\fR\&.

.TP
SrcDirectory
Indique la racine de l'arborescence des paquets source\&. Par défaut, c'est \fI$(DIST)/$(SECTION)/source/\fR\&.

.TP
Packages
Indique le fichier «\~Packages\~» créé\&. Par défaut, c'est \fI$(DIST)/$(SECTION)/binary\-$(ARCH)/Packages\fR\&.

.TP
Sources
Indique le fichier «\~Packages\~» crée\&. Par défaut, c'est \fI$(DIST)/$(SECTION)/source/Sources\fR\&.

.TP
InternalPrefix
Indique un préfixe de chemin\~; ce préfixe fait qu'un lien symbolique sera considéré comme un lien interne plutôt que comme un lien externe\&. Par défaut, c'est \fI$(DIST)/$(SECTION)/\fR\&.

.TP
Contents
Indique le fichier «\~Contents\~» créé\&. Par défaut, c'est \fI$(DIST)/Contents\-$(ARCH)\fR\&. Quand le paramètrage fait que différents fichiers «\~Packages\~» se réfèrent à un seul fichier «\~Contents\~», \fBapt\-ftparchive\fR les intègre automatiquement\&.

.TP
Contents::Header
Indique l'en\-tête à préfixer au fichier «\~Contents\~» créé\&.

.TP
BinCacheDB
Indique la base de données binaire servant de cache pour cette section\&. Différentes sections peuvent partager cette base de données\&.

.TP
FileList
Indique qu'au lieu de lire l'arborescence, \fBapt\-ftparchive\fR doit lire la liste de fichiers dans le fichier donné en argument\&. Les noms relatifs sont préfixés par le répertoire de l'archive\&.

.TP
SourceFileList
Indique qu'au lieu de lire l'arborescence, \fBapt\-ftparchive\fR doit lire la liste de fichiers dans le fichier donné en argument\&. Les noms relatifs sont préfixés par le répertoire de l'archive\&. On s'en sert pour traiter les index de sources\&.

.SS "La section Tree"

.PP
La section Tree définit une arborescence debian classique avec un répertoire de base, différentes sections dans ce répertoire et différentes architectures dans chaque section\&. Le chemin exact est défini par la variable de substitution Directory\&.

.PP
La section Tree accepte une étiquette de visée (scope tag) qui détermine la variable $(DIST) et la racine de l'arborescence (le chemin est préfixé par ArchiveDir)\&. C'est par exemple\~: \fIdists/woody\fR\&.

.PP
Tous les paramètres définis dans la section TreeDefault peuvent s'utiliser dans la section Tree ainsi que les trois nouvelles variables suivantes\&.

.PP
Quand il exécute la section Tree, \fBapt\-ftparchive\fR agit ainsi\~: .IP .nf for i in Sections do for j in Architectures do Generate for DIST=scope SECTION=i ARCH=j .fi 

.TP
Sections
C'est une liste de sections séparées par des espaces qui appartiennent à une distribution\~; classiquement, on trouve main contrib non\-free\&.

.TP
Architectures
C'est une liste de toutes les architectures qui appartiennent à chaque section\&. L'architecture spéciale «\~source\~» indique que l'arborescence est une arborescence de sources\&.

.TP
BinOverride
Indique le fichier binaire d'«\~override\~»\&. Ce fichier contient des informations sur la section, la priorité et le responsable du paquet\&.

.TP
SrcOverride
Indique le fichier source d'«\~override\~»\&. Ce fichier contient des informations sur la section\&.

.TP
ExtraOverride
Indique un autre fichier d'«\~override\~» pour les binaires\&.

.TP
SrcExtraOverride
Indique un autre fichier d'«\~override\~» pour les sources\&.

.SS "La section BinDirectory"

.PP
La section bindirectory définit une arborescence binaire sans structure particulière\&. L'étiquette de visée (scope tag) indique l'emplacement du répertoire binaire et le paramètrage est identique à celui pour la section Tree sans substitution de variables ou au paramètrage de SectionArchitecture\&.

.TP
Packages
Indique le fichier «\~Packages\~» créé\&.

.TP
SrcPackages
Indique le fichier «\~Sources\~» créé\&. L'un des deux fichiers, Packages ou SrcPackages est nécessaire\&.

.TP
Contents
Indique le fichier «\~Contents\~» créé\&.

.TP
Binoverride
Indique le fichier d'«\~override\~» pour les binaires\&.

.TP
SrcOverride
Indique le fichier d'«\~override\~» pour les sources\&.

.TP
ExtraOverride
Indique un autre fichier d'«\~override\~» pour les binaires\&.

.TP
SrcExtraOverride
Indique un autre fichier d'«\~override\~» pour les sources\&.

.TP
BinCacheDB
Indique une base de données cache\&.

.TP
PathPrefix
Ajoute un chemin à tous les chemins créés\&.

.TP
FileList, SourceFileList
Indique le fichier contenant la liste des fichiers\&.

.SH "LE FICHIER D'« OVERRIDE » POUR LES BINAIRES."

.PP
Le fichier d'«\~Override\~» est pleinement compatible avec \fB\fBdpkg\-scanpackages\fR\fR(8) \&. Il contient quatre champs séparés par des espaces\&. Le premier est le nom du paquet\~; le deuxième est la priorité à donner à ce paquet\~; le troisième est sa section et le dernier champ est un champ pour changer le nom du responsable de paquet\&.

.PP
Le champ du responsable est de cette forme\~: 

.nf
old [// oldn]* => new
.fi
 ou simplement, 

.nf
new
.fi
 La première forme permet de spécifier de vieilles adresses dans une liste (le séparateur est la double barre oblique)\&. Si l'une de ces deux formes est rencontrée, la valeur de new remplace la valeur du champ\&. La deuxième forme remplace inconditionnellement le champ\&.

.SH "LE FICHIER D'« OVERRIDE » POUR LES SOURCES"

.PP
Le fichier d'«\~Override\~» est pleinement compatible avec \fB\fBdpkg\-scansources\fR\fR(8) \&. Il contient deux champs\&. Le premier est le nom du paquet source\~; le second, sa section\&.

.SH "LE FICHIER SUPPLéMENTAIRE D'« OVERRIDE »"

.PP
Le fichier supplémentaire d'«\~Override\~» permet d'ajouter ou de remplacer des étiquettes sur la sortie\&. Il possède trois colonnes\~: la première représente le paquet, la seconde est une étiquette et la troisième en fin de ligne est la nouvelle valeur\&.

.SH "LES OPTIONS"

.PP
Toutes les options en ligne de commande peuvent être positionnées via le fichier de configuration\~; les descriptifs indiquent l'option de configuration à positionner\&. En ce qui concerne les options booléennes, on peut annuler le fichier de configuration en utilisant quelque chose comme \fB\-f\-\fR,\fB\-\-no\-f\fR, \fB\-f=no\fR ou d'autres variantes\&.

.TP
\fB\-\-md5\fR
Créer la somme de contrôle MD5\&. Cette option est activée par défaut\&. Quand elle est désactivée, les fichiers d'index n'ont pas les champs MD5Sum là où c'est possible\&. Élément de configuration\~: APT::FTPArchive::MD5\&.

.TP
\fB\-d\fR, \fB\-\-db\fR
Utiliser une base de données binaire pour cache\&. Cela n'a aucun effet sur la commande generate\&. Élément de configuration\~: APT::FTPArchive::DB\&.

.TP
\fB\-q\fR, \fB\-\-quiet\fR
Mode silencieux\~; cette commande produit une sortie destinée à l'enregistrement dans un fichier\-journal en omettant les indicateurs de progression\&. Un plus grand nombre de «\~q\~» (2 au plus) produit un plus grand silence\&. On peut aussi utiliser \fB\-q=#\fR pour positionner le niveau de silence, et annuler le fichier de configuration\&. Élément de configuration\~: quiet\&.

.TP
\fB\-\-delink\fR
Faire une déliaison\&. Si External\-Links est activé, cette option permet réellement la déliaison des fichiers\&. Par défaut, elle est activée mais elle peut être désactivée avec l'option \fB\-\-no\-delink\fR\&. Élément de configuration\~: APT::FTPArchive::DeLinkAct\&.

.TP
\fB\-\-contents\fR
Permettre la création d'un fichier «\~Contents\~»\&. Quand cette option est activée et que les index sont créés sous forme de base de données binaire, la liste des fichiers est aussi extraite et conservée dans la base de données pour un usage futur\&. Avec la commande generate, cette option permet la création de fichiers «\~Contents\~»\&. Par défaut, elle est activée\&. Élément de configuration\~: APT::FTPArchive::Contents\&.

.TP
\fB\-s\fR, \fB\-\-source\-override\fR
Indique le fichier d'«\~override\~» à utiliser avec la commande sources\&. Élément de configuration\~: APT::FTPArchive::SourceOverride\&.

.TP
\fB\-\-readonly\fR
N'autoriser que la lecture pour les bases de données de cache\&. Élément de configuration\~: APT::FTPArchive::ReadOnlyDB\&.

.TP
\fB\-h\fR, \fB\-\-help\fR
Affiche un mode d'emploi succinct\&.

.TP
\fB\-v\fR, \fB\-\-version\fR
Affiche la version du programme\&.

.TP
\fB\-c\fR, \fB\-\-config\-file\fR
Fichier de configuration\~; indique quel fichier de configuration utiliser\&. Le programme lit le fichier de configuration par défaut, puis celui\-ci\&. Voyez \fB\fIapt\&.conf\fR\fR(5)  pour la syntaxe\&.

.TP
\fB\-o\fR, \fB\-\-option\fR
Donne une option de configuration\~; cela fixe une option de configuration arbitraire\&. La syntaxe est : \fB\-o Foo::Bar=bar\fR\&.

.SH "VOIR AUSSI"

.PP
\fB\fIapt\&.conf\fR\fR(5)  

.SH "DIAGNOSTICS"

.PP
 \fBapt\-ftparchive\fR retourne zéro si tout se passe bien, le nombre décimal 100 en cas d'erreur\&.

.SH "BOGUES"

.PP
Voyez la page concernant les bogues de APT: \fIhttp://bugs.debian.org/src:apt\fR\&. Si vous voulez rapporter un bogue, consultez le texte \fI/usr/share/doc/debian/bug\-reporting\&.txt\fR ou utilisez la commande \fB\fBreportbug\fR\fR(1) \&.

.SH "TRADUCTION"

.PP
Philippe Batailler\&. <debian\-l10n\-french@lists\&.debian\&.org>\&. 2005\&.

.SH AUTHORS
Jason Gunthorpe, APT team.
