.\" update-alternatives.8
.\" This man page is copyright 1997 Charles Briscoe-Smith
.\" This is free documentation; you can redistribute it and/or modify
.\" it under the terms of the GNU General Public License as published
.\" by the Free Software Foundation; either version 2 of the License, or
.\" (at your option) any later version.  There is NO WARRANTY.  You can
.\" find the GNU GPL in /usr/share/common-licenses/GPL on any Debian system.
.\"
.\" Original manpage cvs revision 1.8.2.2
.\"WORD:	action		アクション
.\"WORD:	parameter	引き数
.\"WORD:	generic name	一般名
.\"WORD:	alternative	選択肢
.\"
.TH UPDATE-ALTERNATIVES 8 "19 January 1998" "Debian Project" "dpkg utilities"
.SH 名前
update-alternatives \- シンボリックリンクを管理してデフォルトのコマンドを決定する
.SH 書式
.B update-alternatives
.RI [ options ]
.B --install
.I link name path priority
.RB [ --slave
.I link name
.IR path ]...
.PP
.B update-alternatives
.RI [ options ]
.B --remove
.I name path
.PP
.B update-alternatives
.RI [ options ]
.B --remove-all
.I name
.PP
.B update-alternatives
.RI [ options ]
.B --all
.PP
.B update-alternatives
.RI [ options ]
.B --auto
.I name
.PP
.B update-alternatives
.RI [ options ]
.B --display
.I name
.PP
.B update-alternatives
.RI [ options ]
.B --list
.I name
.PP
.B update-alternatives
.RI [ options ]
.B --config
.I name
.PP
.B update-alternatives
.RI [ options ]
.B --set
.I name path
.SH 説明
.B update-alternatives
は Debian の alternatives システムを成すシンボリックリンクを
生成・削除・管理したり、リンクの情報を表示したりする。
.PP
同じ機能を (あるいは似たような機能を) 持つ複数のプログラムを
一つのシステムにインストールし、共存させることができる。
例えば多くのシステムでは、複数のテキストエディタを共存させている。
これにより、システムのユーザは好みに応じて別々のエディタを
使うことができるようになる。
しかしプログラムにとっては、
特に指定がなかったときにどのエディタを起動すれば良いのかという、
なかなか難しい問題を抱えることになる。
.PP
Debian の alternatives システムは、この問題を解決するためのものである。
同じ機能を提供し、互いに置き換え可能な全てのファイルは、
ファイルシステム中の「一般名 (generic name)」を共有する。
その一般名が実際にどのファイルを参照するかは、
alternatives システムとシステム管理者とが決定する。
例えば、テキストエディタである
.BR ed (1)
と
.BR nvi (1)
の両方がシステムにインストールされていたとすると、
一般名である
.I /usr/bin/editor
は、デフォルトでは
.I /usr/bin/nvi
を参照する。システム管理者はこれを上書きし、
.I /usr/bin/ed
を参照させるようにすることもできる。こうすると、
その後明示的なリクエストがなければ、
alternatives システムはその設定を変更しない。
.PP
一般名は、選ばれた「選択肢 (alternative)」への直接のシンボリックリンクではなく、
.I alternatives
ディレクトリにある名前へのシンボリックリンクになっている。
そしてその名前が実際に参照されるファイルへのシンボリックリンクになっている。
こうなっている理由は、システム管理者の変更が
.I /etc
ディレクトリ以下で行われるようにするためである。
なぜこうするのが良いかについては FHS に説明がある。
.PP
置き換え可能な一群のファイル中のどれかを含むパッケージが
インストール・変更・削除されると、
.B update-alternatives
が呼ばれ、そのファイルに対する alternatives システムの内部情報を更新する。
.B update-alternatives
は、通常 Debian パッケージの
.B postinst
または
.B prerm
スクリプトから呼び出される。
.PP
複数の選択肢を同期させ、グループとして変更すると便利なことが多い。
例えば
.BR vi (1)
エディタのいろいろな派生システムが同時にインストールされていたとすると、
.I /usr/share/man/man1/vi.1
が参照する man ページは、
.I /usr/bin/vi
が参照する実行ファイルに対応しているべきであろう。
.B update-alternatives
は、
.I master
リンクと
.I slave
リンクによってこれを取り扱う。
master が変更されると、それに関連づけされた各 slave も同時に変更される。
master リンクとそれに関連づけされた slave とは、
.I "リンクグループ"
を形成する。
.PP
各リンクグループは、いかなる時点においても、
automatic または manual の 2 つのモードのいずれかにある。
グループが automatic モードにある場合は、
パッケージのインストール・削除の際に
リンクを更新するかどうか/どのように更新するかは、
alternatives システムが自動的に決定する。
manual モードでは、
alternatives システムはリンクを変更しない。
システム管理者が行った決定がずっと保存される。
.PP
リンクグループは、システムに導入されると、まず automatic モードになる。
システム管理者がその設定を変更すると、次に
.B update-alternatives
がリンクグループに対して実行されたときに変更が認識され、
そのリンクグループは自動的に manual モードに切り換わる。
.PP
各選択肢は
.I priority
属性を持っている。リンクグループが automatic モードにあるときは、
.I priority
のもっとも高いものが、
そのグループのメンバーが参照する選択肢になる。
.PP
.I --config
オプションを用いると、
.B update-alternatives
は与えられた master リンクのリンクグループに対応する選択肢をすべてリストする。
そしてそのリンクグループにどれを対応させるかを問い合わせる
プロンプトが表示される。
ここで変更を行うと、その一般名は
.I auto
モードではなくなる。 automatic 状態に戻すには、
.I --auto
オプションを用いる必要がある。
.PP
非対話的に設定をしたい場合は
.I --set
オプションを代わりに使用する(以下を参照)。
.SH 用語
.B update-alternatives
の動作は極めて複雑なので、ここでいくつか特殊な用語を説明し、
動作の理解の助けとしたい。
.TP
一般名 (generic name)
.I /usr/bin/editor
のような名前。 alternatives システムによって
同様の機能を持つ複数のファイルのどれかひとつを参照する。
.TP
symlink
特に他に指定がなければ、これは alternatives ディレクトリ内の
シンボリックリンクを意味する。システム管理者が調整の対象とするものである。
.TP
選択肢 (alternative)
ファイルシステム中の特定のファイル。
alternatives システムによって、
一般名からアクセスされるようにできる。
.TP
alternatives ディレクトリ
symlink を保持するディレクトリ。デフォルトは
.IR /etc/alternatives 。
.TP
administrative ディレクトリ
.B update-alternatives
の状態情報を保持するディレクトリ。デフォルトは
.IR /var/lib/dpkg/alternatives 。
.TP
リンクグループ
関連する symlink のセット。グループごと更新するためのもの。
.TP
master リンク
リンクグループに属するリンクで、
グループの他のリンクの設定を決定するもの。
.TP
slave リンク
リンクグループに属するリンクで、
master リンクの設定によって制御されるもの。
.TP
automatic モード
リンクグループが automatic モードにあるときは、
そのグループに対応しており、
かつもっとも高い priority を持つ選択肢をグループ内の各リンクが参照する。
この調整は alternatives システムが自動的に行う。
.TP
manual モード
リンクグループが manual モードにあるときは、
alternatives システムはシステム管理者の設定を一切変更しない。
.SH 例
例えば
.BR nvi
や
.BR vim
のように、テキストエディタ
.BR vi
と互換性のあるプログラムを提供するパッケージが複数ある。
どのパッケージが使われるかは、リンクグループ
.BR vi
によって制御される。リンクグループ
.BR vi
にはプログラム自身のリンクと、関連する man ページのリンクが含まれる。
.PP
.B vi
を提供するパッケージとその現在の設定を表示するには、
.I --display
アクションを使う。
.RS
.PP
update-alternatives --display vi
.RE
.PP
特定の
.B vi
実装を選ぶには、root としてこのコマンドを実行し、そして一覧から数字を選ぶ。
.RS
.PP
update-alternatives --config vi
.RE
.PP
.B vi
実装の選択を自動的に行なうように戻すには、root としてこのコマンドを実行する。
.RS
.PP
update-alternatives --auto vi
.RE
.SH オプション
.B update-alternatives
に何らかの意味のある仕事をさせるには、
アクションを 1 つだけ指定しなければならない。
共通オプションは、どのアクションともいっしょに、いくつでも指定してかまわない。
.SS 共通オプション
.TP
.B --verbose
.B update-alternatives
が行っている作業に付いて、より詳細なコメントを生成する。
.TP
.B --quiet
エラー以外のコメントを出さない。
このオプションはまだ実装されていない。
.TP
.B --test
実際の作業は何もせず、行う予定の作業について表示する。
このオプションはまだ実装されていない。
.TP
.B --help
利用法に関する表示を行う
.RB ( update-alternatives
のバージョンも表示する)。
.TP
.B --version
.B update-alternatives
のバージョンを表示する(利用法に関する表示も行う)。
.TP
\fB--altdir\fR \fIdirectory\fR
alternatives ディレクトリをデフォルトから変えたいときに指定する。
.TP
\fB--admindir\fR \fIdirectory\fR
administrative ディレクトリをデフォルトから変えたいときに指定する。
.SS アクション
.TP
\fB--install\fR \fIlink gen path pri\fR [\fB--slave\fR \fIslink sgen spath\fR] ...
選択肢のグループをシステムに追加する。
.I gen
は master リンクの一般名・
.I link
はその symlink の名前・
.I path
はここで導入される、 master リンクに対応した選択肢、である。
.IR sgen ", " slink ", " spath
はそれぞれ slave リンクの一般名・symlink・選択肢である。
.B --slave
オプションと、それに続く 3 つの引数のセットは、
0 個以上いくつでも指定してよい。
.IP
指定した master の symlink が既に
alternatives システムの記録に存在していると、
与えられた情報はそのグループに対する
新たな選択肢のセットとして追加される。
グループが automatic モードにあり、
新たに追加された選択肢の priority がそのグループに対して
インストールされている他の選択肢のものより高いときには、
symlink は新たに追加された選択肢を参照するように更新される。
.TP
\fB--set\fR \fIname path\fR
プログラム
.I path
を
.I name
の選択肢として設定する。
.IB --config
と同等だが、こちらは非対話的であるため、スクリプト向けである。
.TP
\fB--remove\fR \fIname path\fR
(master の) 選択肢とそれに関連する全ての slave リンクを削除する。
.I name
は alternatives ディレクトリ中の名前であり、
.I path
は
.I name
のリンク先に指定できる、絶対パスでのファイル名である。
.I name
が実際に
.I path
にリンクされている場合には、
.I name
は他の適切な選択肢を参照するよう更新される。
あるいはそのような選択肢が残っていなければ削除される。
関連する slave リンクも対応して更新 (削除) される。
.I name
が現在その
.I path
を参照していなければ、リンクの変更は行われない。
その選択肢の情報が削除されるだけである。
.TP
\fB--remove-all\fR \fIname\fR
すべての選択肢と、それに関連するすべての slave リンクを削除する。
.I name
は、alternative ディレクトリの名前である。
.TP
.B --all
\fB--config\fP をすべての選択肢について呼び出す。
.TP
\fB--auto\fR \fIlink\fR
master の symlink
.I link
を automatic モードに変更する。
この処理を行う際には、
この master リンクと対応する各 slave は、
現在インストールされている alterantive のうち、
もっとも priority の高いものを参照するように更新される。
.TP
\fB--display\fR \fIlink\fR
.I link
を master リンクとするリンクグループの情報を表示する。
表示される情報は、グループのモード (auto か manual か)・
その symlink の現在の参照先・
他に alternatives (とそれに対応した slave altarnative)
があるかどうか・
現在インストールされている選択肢のうち、
もっとも priority の高いもの、である。
.TP
\fB--list\fR \fIlink\fR
リンクグループのすべてのターゲットを表示する。
.TP
\fB--config\fR \fIlink\fR
リンクグループの利用可能なすべての選択肢を表示し、対話的に選択肢の
1 つを選べるようにする。リンクグループは更新され、
.I auto
モードではなくなる。
.SH ファイル
.TP
.I /etc/alternatives/
デフォルトの alternatives ディレクトリ。
.B --altdir
オプションによって変更できる。
.TP
.I /var/lib/dpkg/alternatives/
デフォルトの administration ディレクトリ。
.B --admindir
オプションによって変更できる。
.SH 終了ステータス
.IP 0
リクエストされたアクションが正しく実行された。
.IP 2
コマンドラインの解釈を行うときか、
アクションを実行するときに問題が起った。
.SH 診断メッセージ
.B update-alternatives
は、動作の最中に、いま何をやっているかを逐一標準出力にしゃべり続ける。
問題が起きると、
.B update-alternatives
はエラーメッセージを標準エラー出力に出力し、
終了ステータス 2 を返す。
これらの診断メッセージは、読めばわかるはずである。
もしわからなければ、バグとして報告して欲しい。
.SH バグ
バグを見つけたら、 Debian のバグ追跡システムを使ってレポートして欲しい。
それ無理なら、著者に直接電子メールで送って欲しい。
.PP
もし
.B update-alternatives
の動作とこのマニュアルページの記述に矛盾があれば、
実装か文書、どちらかのバグである。レポートをお願いしたい。
.SH 著者
Debian update-alternatives is copyright 1995
Ian Jackson.  It is free software; see the GNU General Public Licence
version 2 or later for copying conditions.  There is NO warranty.
.PP
This manual page is copyright 1997/98 Charles Briscoe-Smith.
This is free documentation; see the GNU General Public Licence
version 2 or later for copying conditions.  There is NO WARRANTY.
.PP
You can find the GNU GPL in /usr/share/common-licenses/GPL on any Debian system.
.SH 関連項目
.BR ln (1),
FHS, the Filesystem Hierarchy Standard.
.SH 翻訳者
中野武雄 <nakano@apm.seikei.ac.jp>
.SH 翻訳者注
このマニュアルページは dpkg パッケージに付属の
.BR update-alternatives (8)
の日本語訳である。
翻訳対象は CVS revision が 1.8.2.2 のものである。
