-*- mode: m4 -*-
AC_PREREQ(2.52)

m4_define(pyhil_major_version, 0)
m4_define(pyhil_minor_version, 7)
m4_define(pyhil_micro_version, 0)
m4_define(pyhil_version, pyhil_major_version.pyhil_minor_version.pyhil_micro_version)

AC_INIT(python-hildon, pyhil_version)

AC_DEFINE(PYHIL_MAJOR_VERSION, pyhil_major_version,
          [python-hildon major version])
AC_SUBST(PYHIL_MAJOR_VERSION, pyhil_major_version)
AC_DEFINE(PYHIL_MINOR_VERSION, pyhil_minor_version,
          [python-hildon minor version])
AC_SUBST(PYHIL_MINOR_VERSION, pyhil_minor_version)
AC_DEFINE(PYHIL_MICRO_VERSION, pyhil_micro_version,
          [python-hildon micro version])
AC_SUBST(PYHIL_MICRO_VERSION, pyhil_micro_version)

AC_CONFIG_SRCDIR([hildonmodule.c])

AM_INIT_AUTOMAKE

AC_CANONICAL_BUILD
AC_CANONICAL_HOST

AC_DISABLE_STATIC
AC_PROG_LIBTOOL

AM_PATH_PYTHON(2.4)

dnl Figure out PYTHON_INCLUDES

AC_MSG_CHECKING(for headers required to compile python extensions)
dnl deduce PYTHON_INCLUDES
py_prefix=`$PYTHON -c "import sys; print sys.prefix"`
py_exec_prefix=`$PYTHON -c "import sys; print sys.exec_prefix"`
PYTHON_INCLUDES="-I${py_prefix}/include/python${PYTHON_VERSION}"
if test "$py_prefix" != "$py_exec_prefix"; then
  PYTHON_INCLUDES="$PYTHON_INCLUDES -I${py_exec_prefix}/include/python${PYTHON_VERSION}"
fi
AC_MSG_RESULT($PYTHON_INCLUDES)
AC_SUBST(PYTHON_INCLUDES)

AC_CONFIG_FILES(
  Makefile
  examples/Makefile
)
AC_OUTPUT
