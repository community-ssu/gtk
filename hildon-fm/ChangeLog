2007-05-16  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 1.9.22
	
	* hildon-fm/hildon-file-system-private.c
	(_hildon_file_system_get_locations): Create a real root location.
	Don't set up MMCs.
	(setup_mmc): Removed.
	(get_special_location_callback): Always accept zero length
	basepaths as candidates.  Add the new location object to the tree
	of special locations.
	(_hildon_file_system_get_special_location): Traverse locations in
	post order so that more specific locations are considered first.
	Call hildon_file_system_special_location_volumes_changed when a
	new location object has been created.

	* configure.ac: Check for gnome-vfs-2.0 as well.

	* hildon-fm/hildon-file-system-root.c,
	hildon-fm/hildon-file-system-root.h,
	hildon-fm/hildon-file-system-voldev.h,
	hildon-fm/hildon-file-system-voldev.c: New.
	* hildon-fm/Makefile.am (libhildonfm_la_SOURCES): Added them.

	* hildon-fm/t.c: New, for testing.
	* hildon-fm/Makefile.am: Added "t" target.

2007-05-11  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 1.9.21

	* hildon-fm/Makefile.am: Removed "t" target, which was only used
	for testing.
	
	Released 1.9.20
	
	* hildon-fm/hildon-file-system-private.c
	(_hildon_file_system_compare_ignore_last_separator): Return FALSE
	when one of the strings is NULL, for extra robustness.

	Released 1.9.19
	
	Support for smb:// locations.  Aka, the "Weirdos from another
	planet" release.

	* hildon-fm/hildon-file-system-special-location.h
	(hildon_file_system_special_location_get_folder,
	hildon-fm/hildon-file-system-special-location.c): New, to let the
	smb:// special location provide their own weird way of listing the
	top-level.
	* hildon-fm/hildon-file-system-model.c (link_file_folder): Use it
	for special locations.

	* hildon-fm/hildon-file-system-smb.c,
	hildon-fm/hildon-file-system-smb.h: New, for the weird smb://
	namespace.
	* hildon-fm/Makefile.am (libhildonfm_la_SOURCES): Added them.

	* hildon-fm/hildon-file-system-private.c
	(_hildon_file_system_get_locations): Setup SMB.

2007-05-07  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 1.9.18
	
	* hildon-fm/hildon-fm1-compat.h: New.
	* hildon-fm/hildon-fm1-compat.c: Move prototypes to
	hildon-fm1-compat.h, include it.
	* hildon-fm/Makefile.am (libhildonfm_la_SOURCES,
	hildonincludeinst_DATA): Add it.

2007-05-02  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 1.9.17
	
	Support for setting the file selection view mode on a file chooser
	dialog widget. (N54390)
	
	* hildon-fm/hildon-file-chooser-dialog.c
	(HILDON_FILE_CHOOSER_DIALOG_TYPE_SELECTION_MODE,
	hildon_file_chooser_dialog_selection_mode_get_type,
	PROP_SELECTION_MODE): New.
	(hildon_file_chooser_dialog_set_property): Handle
	PROP_SELECTION_MODE by passing it to our HildonFileSelection
	widget.
	(hildon_file_chooser_dialog_get_property): Likewise.
	(hildon_file_chooser_dialog_class_init): Register new
	"selection-mode" property.

2007-04-24  Marius Vollmer  <marius.vollmer@nokia.com>

        Released 1.9.16.
	
	* configure.ac, hildon-fm/Makefile.am,
	hildon-fm/hildon-file-system-model.c: Use the hildon thumbnailer
	instead of the osso thumbnailer.  This is just a change in names.

2007-04-18  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-system-info.c (sync_callback): Only copy
	error when it is non-NULL.  Thanks to Jˆrgen Scheibengruber!

2007-04-16  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 1.9.15.
	
	* hildon-fm/hildon-file-system-info.c
	(hildon_file_system_info_async_new): Use g_slice_new0 and
	g_slice_free after all.  The slice allocator is the recommended
	general purpose allocator now.  Thanks to Martyn again for
	explaining this!

	Released 1.9.14.
	
	* hildon-fm/hildon-file-system-info.c
	(hildon_file_system_info_free): Use g_free instead of g_slice_free
	to free the HildonFileSystemInfo structure since we have allocated
	it with g_new0 (N54107).  Thanks to Martyn Russell!

2007-03-23  Tommi Komulainen  <tommi.komulainen@nokia.com>

	* configure.ac: Remove the manual check for gtk-doc and use
	GTK_DOC_CHECK instead
	* doc/hildon-fm.types: Add hildon_file_details_dialog_get_type
	* doc/hildon-fm-docs.xml: Add 'Object Hierarchy', indices and missing
	public API docs for file details dialog and file system info. The rest
	of xml files are for private APIs.
	* doc/gtk-doc.make: Copy from gtk-doc 1.7 and fix '*.sgml'
	prerequisite with $(wildcard) to work in absence of any files. 
	* doc/Makefile.am: Remove inlined gtk-doc.make bits and update to
	gtk-doc 1.7. Define deprecation guards. Update MAINTAINERCLEANFILES.

2007-03-23  Tommi Komulainen  <tommi.komulainen@nokia.com>

	* Makefile.am (MAINTAINERCLEANFILES): Added to clean up cruft
	
2007-03-09  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 1.9.13, to conform with the unified Hildon verisioning
	scheme.  Sorry for the mess.
 
2007-02-27  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 2.13
	
	Use hildon_helper_set_insensitive_message instead of the
	"insensitive-press" signal.
	
	* hildon-fm/hildon-file-chooser-dialog.c
	(_HildonFileChooserDialogPrivate): Removed infobanner_message
	field.
	(insensitive_button): Removed.
	(build_ui): Use hildon_helper_set_insensitive_message instead of
	setting infobanner_message.
	(hildon_file_chooser_dialog_init): Don't connect to
	"insensitive-press" signal.

2007-02-21  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 2.12
	
	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_get_value): Use HildonMimeCategory
	instead of OssoMimeCategory, and HILDON_MIME_CATEGORY_IMAGES
	instead of OSSO_MIME_CATEGORY_IMAGES.  Bad Erik!

	Released 2.11

2007-02-21  Erik Karlsson  <erik.b.karlsson@nokia.com>

        * hildon-fm/hildon-file-system-model.c: Changed from osso-mime.h to
	hildon-mime.h. Changed osso_mime_* functions to hildon_mime_*
	functions.

2007-02-09  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-chooser-dialog.c,
	hildon-fm/hildon-file-details-dialog.c,
	hildon-fm/hildon-file-selection.c: Replaced gtk_object_sink with
	g_object_ref_sink.

	* hildon-fm/hildon-file-selection.c: Don't set "force-list-kludge"
	on GtkTreeViews.
	
2007-02-08  Marius Vollmer  <marius.vollmer@nokia.com>

	* autogen.sh: Put back invocation of configure since that is
	apparently expected to happen by some automated build systems.
	Thanks to Richard Hult for pointing this out!

2007-02-07  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 2.10
	
	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_get_value): Consider nodes that have a
	active get_folder_handle to be folders.
	(handle_possibly_finished_node): Only announce a row change when
	the path is valid.  The path is invalid for the fake root.
	(hildon_file_system_model_get_value): When calculating the weight,
	don't look into info when it is NULL.
	(get_folder_callback): When the folder is finished loading, list
	and add its children immediately.  This is needed for the
	filesystemmemory backend which doesn't emit any change
	notification signals.

	* hildon-fm/hildon-file-system-private.c
	(_hildon_file_system_create_image): Don't call
	gtk_file_info_render_icon with info == NULL.

2007-02-05  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 2.9
	
	* hildon-fm.pc.in: New.
	* configure.ac: Create hildon-fm.pc from it.
	* Makefile.am (pkgconfig_DATA): Added hildon-fm.pc.
	(EXTRA_DIST): Added hildon-fm compatibility kluge files.
	
	Released 2.8
	
	* hildon-fm/Makefile.am (hildon-fm1-compat.c): New.
	(libhildonfm_la_SOURCES): Added hildon-fm1-compat.c

2007-02-02  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 2.7
	
	* Makefile.am (pkgconfig_DATA): Install hildon-fm-2.pc.
	(EXTRA_DIST): Distribute the right files after the renaming.
	(deb): Remove old sources before extracting new ones.
	
	* autogen.sh: Don't call configure.  Always use generic versions
	of the tools instead of specific ones.

	* configure.ac: Don't check for outo.  Use AC_CONFIG_FILES.

	* hildon-fm/Makefile.am (hildonincludeinstdir): Install into
	headers into $(includedir)/hildon-fm-2 so that their locations
	contains the major version.

	* hildon-fm.pc.in, hildon-fm-2.pc.in: Renamed former to latter.

	Released 2.6
	
	* hildon-fm/Makefile.am (hildonincludeinstdir): Install headers
	into <hildon/...> instead of <hildion-widgets/...>.

2007-02-01  Marius Vollmer  <marius.vollmer@nokia.com>

        Released 2.5
	
	Partly adapted to new Hildon API.
	
	* hildon-fm/hildon-file-chooser-dialog.c,
	hildon-fm/hildon-file-details-dialog.c,
	hildon-fm/hildon-file-selection.c: Include <hildon/foo.h> instead
	of <hildon-widgets/foo.h>.  Use hildon_banner_show_information
	instead of gtk_infoprint.  Use gtk_style_lookup_color instead of
	gtk_style_lookup_logical_color.
	* hildon-fm/hildon-file-chooser-dialog.c (response_handler): Don't
	pass argument to file_ib_name_too_long string.  It doesn't have
	formatting codes in it.
	
	Released 2.4
	
	* configure.ac: Check for hildon-1 instead of hildon-libs.
	Explicitly check for gtk+-2.0.

2007-01-30  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 2.3
	
	* hildon-fm/hildon-file-system-settings.c,
	hildon-fm/hildon-file-system-obex.c: Do not define
	DBUS_API_SUBJECT_TO_CHANGE, we expect the real one now.

	* hildon-fm/hildon-file-system-settings.c: Do not include
	<osso-ic-dbus.h>, it is deprecated and no longer in our
	Build-Deps.  Instead, hardcode the icd D-Bus names.

2007-01-29  Marius Vollmer  <marius.vollmer@nokia.com>

	Hildon Consolidation.  References to GtkFilePath in the public
	HildonFileSelection API are removed.
	
	* hildon-fm/hildon-file-selection.h,
	hildon-fm/hildon-file-selection.c,
	hildon-fm/hildon-file-common-private.h
	(_HildonFileSelectionClass): Removed "items-dropped" signal, added
	"uris-dropped" signal.
	(hildon_file_selection_set_current_folder,
	hildon_file_selection_get_current_folder): Removed.
	(hildon_file_selection_set_current_folder_uri,
	hildon_file_selection_get_current_folder_uri): Added as
	replacement.
	(hildon_file_selection_select_path,
	hildon_file_selection_unselect_path,
	hildon_file_selection_get_selected_paths): Removed.
	(hildon_file_selection_select_uri,
	hildon_file_selection_unselect_uri,
	hildon_file_selection_get_selected_uris): Added as replacement.
	(_hildon_file_selection_set_current_folder_path,
	_hildon_file_selection_select_path,
	_hildon_file_selection_unselect_path): Added as internal
	replacement.  Changed all callers.
	(_hildon_file_selection_get_selected_files,
	_hildon_file_selection_realize_help): Moved prototypes to
	"hildon-file-common-private.h".
		
	* hildon-fm/hildon-file-system-model.h
	(HildonFileSystemModelColumns): Renamed
	HILDON_FILE_SYSTEM_MODEL_COLUMN_GTK_PATH column to
	HILDON_FILE_SYSTEM_MODEL_COLUMN_GTK_PATH_INTERNAL.  Changed all
	references.

	* Makefile.am (SUBDIRS): Removed "ut".

2007-01-26  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 2.2 to experimental.

2007-01-22  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-system-private.c
	(_hildon_file_system_compare_ignore_last_separator): Skip
	"file://" prefixes before comparing.
	(hildon_file_system_create_backend): Use gtk_file_system_create
	always.

	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_delayed_add_children): Handle a NULL
	model_node->folder gracefully.
	(get_folder_callback): Rearranged code gratuitously.

	* hildon-fm/hildon-file-common-private.h (_): Use "hildon-fm"
	explicitly as the text domain since the package name has changed.

	* hildon-fm/hildon-file-chooser-dialog.c,
	hildon-fm/hildon-file-selection.c,
	hildon-fm/hildon-file-system-model.c: Removed WITH_GTK_2_10
	conditionals, keep the 2.10 stuff and the 2.6 stuff that now also
	works with maemo-gtk 2.10.

	Removed support for Gtk+ 2.6.
	
        * configure.ac: Require Gtk+ 2.10.0.  Do not check for osso-ic, it
	is unused.  Removed --with-gtk-2-10 configure option.  Removed all
	traces of l10n stuff.  Renamed package to "libhildonfm".

	* hildon-fm/Makefile.am (INCLUDES): Do not use OSSOIC_CFLAGS.
	(libhildonfm_la_LDFLAGS): Bumped major version to 2.
	
2006-12-21  Marius Vollmer  <marius.vollmer@nokia.com>

	Make hildon-fm compile with Gtk+ 2.10.  (Gtk+ 2.6 is broken now.
	Stay tuned.)
	
	* hildon-fm/hildon-file-system-info.c: Rewritten to be
	asynchronous.

	* hildon-fm/hildon-file-chooser-dialog.c: Removed literal copy of
	GtkFileChooserIFace et al for Gtk+ 2.10.  Include
	<gtk/gtkfilechooserutils.h> instead.
	(chooser_entry_invalid_input_cb, hildon_file_chooser_dialog_init):
	Do not use "invalid-input" signal for Gtk+ 2.10.
	(set_stub_and_ext): Do not ask the filesystem for the is_folder
	attribute for now.
	(create_folder_callback, handle_folder_popup): Use the
	asynchronous version of gtk_file_system_create_folder.
	
	* hildon-fm/hildon-file-selection.c: Do not use the tap&hold
	machinery since it is not in Gtk+ 2.10 yet.
	(hildon_file_selection_selection_changed): Expect
	_hildon_file_system_mount_device_iter to return immediately
	without useful error information.
	(thumbnail_data_func): Do not call gtk_style_lookup_logical_color
	for Gtk 2.10 since it doesn't exist there.

	* hildon-fm/hildon-file-system-model.h,
	hildon-fm/hildon-file-system-model.c
	(get_folder_callback): New, factored out of link_folder.
	(link_folder): Made asynchronous by using new asynchronous
	gtk_file_system_get_folder call. Removed 'error' argument, updated
	all callers.
	(_hildon_file_system_mount_device_iter): Removed 'error' argument,
	updated all callers.

	* hildon-fm/hildon-file-system-private.c
	(hildon_file_system_create_backend): Use gtk_file_system_create
	instead of hildon_gtk_file_system_create for Gtk 2.10.

	* hildon-fm/hildon-file-system-private.h
	(_hildon_file_system_create_image): Replace 'path' argument with
	'info' and use gtk_file_info_render_icon instead of
	gtk_file_system_render_icon.  Updated all callers.

2006-12-19  Marius Vollmer  <marius.vollmer@nokia.com>

	* configure.ac: Added --with-gtk-2-10 argument for the Gtk+
	migration.

	Merged changes from 1.19 to 1.21.
	
>    2006-12-18  Marius Vollmer  <marius.vollmer@nokia.com>
>
>	    Released 1.21.
>
>	    * hildon-fm/hildon-file-chooser-dialog.c (set_stub_and_ext): Be
>	    'smarter' about recognizing Rename dialogs in order to get the
>	    is_folder attribute more right (N49932).
>
>    2006-12-15  Marius Vollmer  <marius.vollmer@nokia.com>
>
>	    * hildon-fm/hildon-file-chooser-dialog.c (set_stub_and_ext): Call
>	    hildon_file_chooser_dialog_do_autonaming instead of set_entry so
>	    that the new stub name gets the required autonaming treatment.
>	    That took a while... (N49936).
>
>    2006-12-13  Marius Vollmer  <marius.vollmer@nokia.com>
>
>	    Released 1.20.
>
>	    * hildon-fm/hildon-file-chooser-dialog.c (set_stub_and_ext): Use
>	    gtk_file_system_make_path instead of rolling our own to get URI
>	    escaping right. (N49798) Call set_entry so that the name entry is
>	    updated when the knowledge about whether it is a folder or not
>	    changes but retain the value of 'edited' so that autonaming still
>	    works. (N49799)

2006-12-11  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/Makefile.am (libhildonfm_la_SOURCES): Added
	hildon-file-common-private.h so that it gets distributed. (N49099)
	
2006-12-12  Marius Vollmer  <marius.vollmer@nokia.com>

	Merged changes from 1.16 to 1.19.

>    2006-12-08  Marius Vollmer  <marius.vollmer@nokia.com>
>
>	    Released 1.19.
>
>	    * hildon-fm/hildon-file-system-private.c (hex_digit_to_int,
>	    unescape_string): New.
>	    (_hildon_file_system_create_file_name): Use them to unescape the
>	    fallback display name that is directly extracted from the URI.
>	    (N48904)
>
>    2006-11-30  Marius Vollmer  <marius.vollmer@nokia.com>
>
>	    Released 1.18.
>
>	    Make it possible for special locations to request a rescan, and
>	    use it to keep the obex root folder uptodate.  (N40395)
>
>	    * hildon-fm/hildon-file-system-model.c (location_rescan): New.
>	    (setup_node_for_location): Connect it.
>	    (hildon_file_system_model_destroy_model_node): Expect three
>	    signals to be disconnected.
>	    (hildon_file_system_model_queue_node_reload): Refactored out of
>	    _hildon_file_system_model_queue_reload in order to be able to
>	    reload nodes directly without having to construct a iter first.
>
>	    * hildon-fm/hildon-file-system-obex.h (struct
>	    _HildonFileSystemObex): Added binding_id member.
>	    * hildon-fm/hildon-file-system-obex.c (bonding_changed): New, for
>	    triggering a rescan.
>	    (hildon_file_system_obex_init): Connect it to the file system
>	    settings.
>	    (hildon_file_system_obex_finalize): Disconnect it.
>
>	    * hildon-fm/hildon-file-system-settings.c
>	    (hildon_file_system_settings_get_property,
>	    hildon_file_system_settings_class_init): Added "bonding-changed"
>	    property.
>	    (hildon_file_system_settings_setup_dbus): Catch bonding signals
>	    from Bluez.
>	    (hildon_file_system_settings_handle_dbus_signal): Handle them.
>
>	    * hildon-fm/hildon-file-system-special-location.h (struct
>	    _HildonFileSystemSpecialLocationClass): Added 'rescan' signal.
>	    * hildon-fm/hildon-file-system-special-location.c (enum
>	    HildonFileSystemSpecialLocationSignals,
>	    hildon_file_system_special_location_class_init): Register it.
>
>    2006-11-29  Marius Vollmer  <marius.vollmer@nokia.com>
>
>	    * hildon-fm/hildon-file-system-upnp.c
>	    (hildon_file_system_upnp_init): Use 'device' directly instead of
>	    casting it; it is already the right type.
>
>	    * hildon-fm/hildon-file-chooser-dialog.c (set_stub_and_ext): Do
>	    not set entry widget, that was confusing the internal state
>	    related to autonaming somehow. (N48902)
>	    (hildon_file_chooser_dialog_set_current_folder): Terminate
>	    g_strconcat argument list with NULL, stupid. (N48903)
>
>    2006-11-21  Marius Vollmer  <marius.vollmer@nokia.com>
>
>	    Released 1.17
>
>	    * hildon-fm/hildon-file-system-obex.c
>	    (_obex_addr_to_display_name): Do not call
>	    dbus_connection_disconnect.
>
>	    * hildon-fm/hildon-file-system-upnp.c
>	    (hildon_file_system_upnp_create_child_location): Use
>	    qgn_list_filesys_mediaserver icon instead of
>	    qgn_list_filesys_divc_cls. (N45114)

2006-12-08  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/Makefile.am (libhildonfm_la_SOURCES): Added
	hildon-file-common-private.h so that it gets distributed. (N49099)

2006-11-30  Marius Vollmer  <marius.vollmer@nokia.com>

	From Daniel Elstner <danielk@openismus.com> for the benefit of
	language bindings.

	* hildon-fm/hildon-file-system-model.h
	(HildonFileSystemModelClass): Hide this struct by prefixing an
	underscore.  (M182).
	
2006-11-22  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-details-dialog.c
	(hildon_file_details_dialog_init): Set default title here.
	(hildon_file_details_dialog_new)
	(hildon_file_details_dialog_new_with_model): Don't set it here.
	(M874)
	
	* hildon-fm/hildon-file-chooser-dialog.c (set_entry): Removed
	debugging output.
	(hildon_file_chooser_dialog_select_path): Update name entry widget
	as required by GtkFileChooser behavior. (M469)

	* hildon-fm/hildon-file-selection.c
	(hildon_file_selection_select_unselect_main_iter): Get path from
	sort model, not from filter model since the view shows the sort
	model.

        From JosÈ Dapena Paz <jdapena@i\galia.com>.  Thanks! (M842)
	
 	* hildon-fm/hildon-file-chooser.c: Add available filters to pane
	context menu. The filters are added with method add_filter (and
	removed with remove_filter). Only filters with name are shown, and
	that name is the one used in the context menu.

2006-11-21  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-system-upnp.c
	(hildon_file_system_upnp_create_child_location): Use
	qgn_list_filesys_mediaserver icon instead of
	qgn_list_filesys_divc_cls. (N45114)

        From Murray Cumming  <murrayc@murrayc.com>.  Thanks!
   
 	* configure.ac: Add a check for perl and and a --disable-rebuilds
	option, to control whether the hildon-fm-enums-types.[h|c] will be
	built.  This matches the same build files stuff in hildon-libs.

 	* hildon-fm/Makefile.am: Generate hildon-fm-enums-types.[h|c],
	containing GType declarations for hildon-fm enums, so we can use
	them, for instance, in GValues, and so that enum properties can be
	declared properly, instead of using ints.

2006-11-17  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 2.0
	
	* hildon-fm/hildon-file-system-obex.c
	(_obex_addr_to_display_name): Do not call
	dbus_connection_disconnect.

    Merged changes from 1.14 to 1.16:

>     2006-11-14  Marius Vollmer  <marius.vollmer@nokia.com>
> 
> 	    Released 1.16
> 
> 	    * hildon-fm/hildon-file-chooser-dialog.c
> 	    (hildon_file_chooser_dialog_set_current_folder): Be careful not to
> 	    pass stub_name directly to set_stub_and_ext since it will be freed
> 	    immediately.  (N44784)
> 
> 	    Released 1.15
> 
> 	    * hildon-fm/hildon-file-system-model.c
> 	    (hildon_file_system_model_get_value): Removed hack from 2006-10-10
> 	    and return the normal icon always for COLUMN_ICON.  Otherwise the
> 	    (+) emblem might appear in the wrong place like in the details
> 	    dialog.
> 	    (hildon_file_system_model_load_path): Canonicalize "upnpav:///" to
> 	    "upnpav://" so that we can find the UPnP root when going up the
> 	    hierachy.  If gtk_file_system_get_parent doesn't work, do our own
> 	    filename acrobatics.  Do no insist on having a monitor active for
> 	    the parent node. (N37687)
> 
> 	    * hildon-fm/hildon-file-chooser-dialog.c (set_entry): Be robust
> 	    against NULL names.
> 
>     2006-11-13  Marius Vollmer  <marius.vollmer@nokia.com>
> 
> 	    * hildon-fm/hildon-file-system-upnp.c
> 	    (hildon_file_system_upnp_is_visible,
> 	    hildon_file_system_upnp_is_available): New methods.
> 	    (hildon_file_system_upnp_class_init): Install them.
> 	    (hildon_file_system_upnp_init): Listen to changes to the
> 	    "iap-connected" property and cause ourselves to be rescanned when
> 	    it changes.  (N42105)
> 
> 	    Make it possible to include <osso-ic-dbus.h>
> 	    * configure.ac (OSSOIC_CFLAGS, OSSOIC_LIBS): Added, for "osso-ic".
> 	    * hildon-fm/Makefile.am (INCLUDES): Added OSSOIC_CFLAGS.
> 
> 	    * hildon-fm/hildon-file-system-settings.c: Added "iap-connected"
> 	    property that listens to the "status_changed" signal from
> 	    "com.nokia.icd".
> 
>     2006-11-10  Marius Vollmer  <marius.vollmer@nokia.com>
> 
> 	    * hildon-fm/hildon-file-chooser-dialog.c
> 	    (hildon_file_chooser_dialog_set_current_folder): Be careful not to
> 	    call g_strconcat with a NULL string.
> 
> 	    * hildon-fm/hildon-file-system-obex.c,
> 	    hildon-fm/hildon-file-system-obex.h (struct
> 	    _HildonFileSystemObex): Added has_children member.
> 	    (hildon_file_system_obex_create_child_location): Set has_children
> 	    to true after adding one.
> 	    (hildon_file_system_obex_is_visible): New, to make the bluetooth
> 	    root folder disappear when it is empty.
> 	    (hildon_file_system_obex_init): Set it. (N40395)
> 
> 	    * hildon-fm/hildon-file-system-private.c
> 	    (_hildon_file_system_search_extension): Handle NULL names.
> 	    (_hildon_file_system_create_display_name): Consider all special
> 	    locations to be folders regardless of what 'info' says.
> 
>     2006-11-08  Marius Vollmer  <marius.vollmer@nokia.com>
> 
> 	    * hildon-fm/hildon-file-selection.c
> 	    (hildon_file_selection_finalize): Remove banner_timeout_id and
> 	    banner_close_timeout_id sources. (N46676)
> 
> 	    * hildon-fm/hildon-file-system-private.c
> 	    (_hildon_file_system_create_display_name): Added a gross hack to
> 	    hide extensions of bookmarks in the GtkFileSystemMemory backend.
> 
> 	    * hildon-fm/hildon-file-selection.c: Refactored the sorting
> 	    function so that the sorting of the navigation pane can be
> 	    controlled more precisely. (N45910)
> 	    (sort_function): Added explicit key and order parameters.  Do not
> 	    retrieve them with hildon_file_selection_get_sort_key since that
> 	    function always looks at the content pane sorting parameters.
> 	    (navigation_pane_sort_function): New, use sort_function to sort
> 	    always by name and ascending.
> 	    (content_pane_sort_function): New, use sort_function to sort
> 	    according to hildon_file_selection_get_sort_key.
> 	    (hildon_file_selection_create_sort_model): Added sort_function
> 	    parameter.  Updated all callers accordingly to pass either
> 	    navigation_pane_sort_function or content_pane_sort_function, as
> 	    appropriate.
> 
> 	    * hildon-fm/hildon-file-selection.c
> 	    (hildon_file_selection_constructor): Set the visible_func of the
> 	    content pane filter model.  Thanks to JosÈ Dapena Paz and Tommi
> 	    Komulainen! (M841, N45877)
> 
> 	    Be smarter about dots in file and folder names (N44784).
> 
> 	    * hildon-fm/hildon-file-system-private.h,
> 	    hildon-fm/hildon-file-system-private.c
> 	    (_hildon_file_system_search_extension): Added is_folder parameter
> 	    and behave accordingly.  Updated all callers.  Always search for
> 	    the longest known extension, even when only_known is FALSE.
> 	    (_hildon_file_system_create_display_name): Treat folders specially
> 	    again by setting the is_folder parameter of
> 	    _hildon_file_system_search_extension correctly.
> 
> 	    * hildon-fm/hildon-file-system-model.c
> 	    (hildon_file_system_model_autoname_uri): Get is_folder property
> 	    from model and pass to _hildon_file_system_search_extension.
> 
> 	    * hildon-fm/hildon-file-chooser-dialog.c (set_stub_and_ext): New.
> 	    (hildon_file_chooser_dialog_set_current_folder): Call it so that
> 	    the idea of the file chooser whether we are handling a file or
> 	    folder is uptodate.
> 	    (hildon_file_chooser_dialog_set_current_name): Call
> 	    set_stub_and_ext instead of using explicit code.
> 
>     2006-11-06  Marius Vollmer  <marius.vollmer@nokia.com>
> 
> 	    * hildon-fm/hildon-file-chooser-dialog.c (set_entry, get_entry):
> 	    New, to concentrate the extension handling magic in one place.
> 	    (hildon_file_chooser_dialog_do_autonaming): Use set_entry.
> 	    (hildon_file_chooser_dialog_get_paths): Use get_entry.
> 	    (hildon_file_chooser_dialog_set_current_name): Free ext_name and
> 	    reset it to NULL before setting it anew (maybe).
> 
> 	    * hildon-fm/hildon-file-system-private.h,
> 	    hildon-fm/hildon-file-system-private.c
> 	    (_hildon_file_system_create_display_name): Also strip known
> 	    extensions from folders to be consistent with the rename dialog.
> 	    (get_known_mime_types): Factored out of
> 	    _hildon_file_system_search_extension.
> 	    (_hildon_file_system_search_extension): Use it.  Removed mime_type
> 	    parameter, added only_known parameter.  When only_known is true,
> 	    only consider registered extensions.  Updated all callers.
> 	    (_hildon_file_system_is_known_extension): New.
> 
> 	    * hildon-fm/hildon-file-system-model.c
> 	    (hildon_file_system_model_autoname_uri): Updated for change in
> 	    _hildon_file_system_search_extension.
 
2006-10-23  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 1.14 and started 2.x development series.

	* hildon-fm/hildon-file-system-mmc.c
	(hildon_file_system_mmc_get_extra_info): Removed.
	(hildon_file_system_mmc_class_init): Do not use it.
	(N42731)
	
2006-10-19  Marius Vollmer  <marius.vollmer@nokia.com>

	Code cleanups from Kuisma.
	
	* hildon-fm/hildon-file-chooser-dialog.c
	(chooser_entry_invalid_input_cb): New.
	(hildon_file_chooser_dialog_check_limit): Removed.
	(hildon_file_chooser_dialog_init): Connect
	chooser_entry_invalid_input_cb to "invalid-input" signal instead
	of hildon_file_chooser_dialog_check_limit to "insert-text".
	(insensitive_button): Use hildon_banner_show_information instead
	of gtk_infoprint. (N43716)

2006-10-16  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_real_device_disconnected): Do reset
	load_time and accessed for MMC locations (N42571).  See also the
	change from 2006-09-29.
	
	* hildon-fm/hildon-file-system-obex.c
	(hildon_file_system_obex_class_init): Set requires_access method
	to NULL to get the default behavior.

2006-10-11  Marius Vollmer  <marius.vollmer@nokia.com>

        Added "show-type-icon" property.  (N42979)

	* hildon-fm/hildon-file-details-dialog.c (PROP_SHOW_TYPE_ICON):
	New.
	(hildon_file_details_dialog_class_init): Install it and default to
	FALSE.
	(hildon_file_details_dialog_set_property): Show/hide file_image
	widget as appropriate for it.
	(hildon_file_details_dialog_get_property): Return its current
	value.
	(hildon_file_details_dialog_init): Use a hbox for the type field
	and put the newly created file_image widget into it in addition to
	the label.
	(hildon_file_details_dialog_set_file_iter): Get the icon of the
	iter and put it into the file_image widget.

2006-10-10  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_get_value): Return the collapsed icon
	instead of the normal icon for special locations that require
	access but have not yet been accessed. (N33895)
	(handle_possibly_finished_node): Call gtk_tree_model_row_changed
	when the node is now completely loaded. (N38533)

2006-10-09  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 1.13.
	
	* hildon-fm/hildon-file-system-private.c
	(_hildon_file_system_search_extension): Don't return immediately
	when mime is NULL.  We need to consider all registered extensions
	in that case. (N42601)

	* debian/rules (CFLAGS), hildon-fm/Makefile.am (INCLUDES): Moved
	-DHILDON_FM_HPANED to Makefile.am so that it is always defined.

	* hildon-fm/hildon-file-chooser-dialog.c
	(check_illegal_characters): Do not check for "." and "..", this is
	now done elsewhere.
	(response_handler): Reject names that start with a dot. (N42088)

	* hildon-fm/hildon-file-selection.c: Move definition of
	prev_handle_pos into the HILDON_FM_HPANED conditional.

2006-10-06 Tapani Palli <tapani.palli@nokia.com>

	* hildon-fm/hildon-file-selection.c : listen to notify::position,
	if the position of the hpaned handle is moved, move it back to
	previous position. (N29728)

2006-10-04  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 1.12.
	
	* hildon-fm/hildon-file-selection.c
	(hildon_file_selection_close_load_banner): Make sure that the row
	with the cursor is in the selection. (N42110)
	(hildon_file_selection_selection_changed): Free current_folder
	before setting a new one.

2006-10-02  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 1.11.
	
	* hildon-fm/hildon-file-system-mmc.c (capitalize_ascii_string):
	Advance pointer after uppercasing the first char, stupid.

2006-09-29  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-system-mmc.c (capitalize_ascii_string):
	New.
	(hildon_file_system_mmc_get_display_name): Use it to nicify the
	names. (N40288)

	* configure.ac (BTTOOLS_CFLAGS): Removed.
	* hildon-fm/Makefile.am (INCLUDES): Don't use BTTOOLS_CFLAGS.

	* hildon-fm/hildon-file-system-private.c
	(_hildon_file_system_search_extension): If mime is NULL, just
	return the part after the last dot. (N40336)

	* hildon-fm/hildon-file-selection.c
	(hildon_file_selection_check_location): Do not retreat to safe
	folder.
	(hildon_file_selection_selection_changed): Disable cursor magic
	when unreffing the sort_model.  Don't retreat do the old folder
	when mounting fails.

	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_real_device_disconnected): Do not reset
	'load_time' and 'accessed' fields of device node.  This better
	reflects reality and makes it easier to control when the node is
	reloaded.
	(location_connection_state_changed): Likewise.
	(node_needs_reload): Reload unwatched nodes when forced.
	(_hildon_file_system_model_mount_device_iter): Set 'accessed' to
	TRUE even for failures.
	
2006-09-29 Tapani Palli <tapani.palli@nokia.com>

	* hildon-fm/hildon-file-system-settings.c:
	read MMC_USED_KEY value from gconf in delayed_init

2006-09-28  Xan Lopez  <xan.lopez@nokia.com>

	* hildon-fm/hildon-file-chooser-dialog.c (build_ui): 
	Use a variable to hold the infobanner message the for insensitive
	button press callback instead of hardcoding it. (N41719).

2006-09-28  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-system-private.c
	(_hildon_file_system_get_locations): Move ".games" folder to root.
	(N37440)
	
	* hildon-fm/hildon-file-chooser-dialog.c
	(check_illegal_characters): Removed '.' again from the list of
	illegal characters.
	(hildon_file_chooser_dialog_set_limit): Don't try to be smart
	about the full pathname length, only use max_filename_length to
	limit the entry field. (N32010)

	* hildon-fm/hildon-file-system-settings.c: Don't include
	<bttools-dbus.h>, it is deprecated.
	(BTNAME_SERVICE, BTNAME_REQUEST_IF, BTNAME_SIGNAL_IF,
	BTNAME_REQUEST_PATH, BTNAME_SIGNAL_PATH, BTNAME_REQ_GET,
	BTNAME_SIG_CHANGED): New, using the "bluez.org" D-Bus API.
	(N41462)
	
2006-09-27 Tapani Palli <tapani.palli@nokia.com>

	* hildon-fm/hildon-file-system-remote-device.c : initialize
	device->accessible using the !flight_mode value

2006-09-27  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_search_path_internal): Also consider the
	parent node itself as a potential search hit. (N41347)

	Released 1.10.9.
	
	Provide the hildon_file_selection_move_cursor_to_uri (N40983).
	
	* hildon-fm/hildon-file-selection.h
	(hildon_file_selection_move_cursor_to_uri): New prototype.
	* hildon-fm/hildon-file-selection.c
	(hildon_file_selection_enable_cursor_magic_for_model,
	hildon_file_selection_enable_cursor_magic): Renamed former to
	latter, changed all callers.  Also connects row_inserted signal.
	(hildon_file_selection_disable_cursor_magic): New.
	(HildonFileSelectionPrivate): Added cursor_goal_uri field.
        (hildon_file_selection_finalize): Call disable_magic.  Free
	cursor_goal_uri.
	(set_cursor_idle_handle, set_cursor_when_idle,
	get_view_for_model): New.
	(hildon_file_selection_row_deleted): Don't set cursor when we have
	a cursor_goal_uri.
	(hildon_file_selection_row_inserted): New, for tracking the
	cursor_goal_uri.
	(hildon_file_selection_move_cursor_to_uri): New.
	(hildon_file_selection_selection_changed): Don't call
	hildon_file_selection_delayed_select_reference when nothing is
	selected, we take care of the cursor now with
	hildon_file_selection_enable_cursor_magic et al.

2006-09-27  Xan Lopez  <xan.lopez@nokia.com>

	* hildon-fm/hildon-file-system-upnp.c: 
	(root_failed_message): Removed, since it is not specified.
	(hildon_file_system_upnp_init): Set failed_access_message to NULL instead.
	(NB#41283).

2006-09-21  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-chooser-dialog.c
	(check_illegal_characters): Added '.' to list of illegal
	characters. (N40732)

2006-09-19  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-system-obex.c
	(root_failed_message): Removed, since it is not specified.
	(hildon_file_system_obex_init): Set failed_access_message to NULL
	instead.  Thanks to Jouni Tulkki for the patch!  (N39687)

2006-09-19  Xan Lopez  <xan.lopez@nokia.com>

	* hildon-fm/hildon-file-selection.c
	(hildon_file_selection_constructor): Fix memory leak, NB#34417.

2006-09-18  Fernando Herrera  <fernando.herrera-de-las-heras@nokia.com>

	* hildon-fm/hildon-file-details-dialog.c:
	(hildon_file_details_dialog_init): Ellipsize location on details
        dialog. (N38147)

2006-09-18  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 1.10.

2006-09-18  Fernando Herrera  <fernando.herrera-de-las-heras@nokia.com>

	* hildon-fm/hildon-file-chooser-dialog.c
	(hildon_file_chooser_entry_changed): Make OK button insensitive
	when text entry is empty in the Create Folder/Rename/Move dialogs
	(N33732)

2006-09-18  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_delayed_add_node_list_timeout): Call
	hildon_file_system_model_delayed_add_children with FORCE set to
	true.

	* hildon-fm/hildon-file-selection.c
	(hildon_file_selection_content_pane_selection_changed): First
	argument to callback is a GtkTreeSelection, not a GtkWidget (but
	it was unused).
	(hildon_file_selection_close_load_banner): Replaced logic when and
	how to select the first row with something simpler that is
	hopefully just as good.  Specifically, the curser is simply set to
	the first row when it wasn't set previously.
	(hildon_file_selection_set_cursor_stubbornly): New.
	(hildon_file_selection_row_deleted): New.
	(hildon_file_selection_enable_cursor_magic_for_model): New.
	(hildon_file_selection_selection_changed,
	hildon_file_selection_setup_dnd_view): Call it for the sort_model.
	(hildon_file_selection_create_dir_view): Call it for the
	dir_filter. (N30868)

2006-09-15  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-system-settings.c
	(hildon_file_system_settings_setup_dbus): Wait for the bluetooth
	name request to finish before returning so that people always get
	a good name even if they are not tracking changes.  Thanks Jouni
	Tulkki for the patch. (N39128)

2006-09-15  Fernando Herrera  <fernando.herrera-de-las-heras@nokia.com>

	* hildon-fm/hildon-file-details-dialog.c
	(hildon_file_details_dialog_init): Ellipsize name on details
	dialog. (N40046)

2006-09-14  Fernando Herrera  <fernando.herrera-de-las-heras@nokia.com>

	* hildon-fm/hildon-file-chooser-dialog.c
	(hildon_file_chooser_dialog_do_autonaming): Fix the pos/selection
	when autonaming a file (N39834). (Also cleaned ChangeLog)

2006-09-13  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-selection.c
	(hildon_file_selection_select_unselect_main_iter): The sort_model
	is the parent of the filter_view, not the other way around.
	Corrected conversion and usage of iters accordingly.  (N39660)

2006-09-13  Kimmo H√§m√§l√§inen  <kimmo.hamalainen@nokia.com>

	* hildon-fm/hildon-file-system-mmc.c: Added a proper private struct
        and a property for specifying which memory card is which.

        Order of memory cards is now fixed (NB#38145).
        Fixed the localised name of an unnamed (or non-FAT) memory card
	(NB#35433).

2006-09-08  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-common-private.h (KE): New.

	* hildon-fm/hildon-file-selection.c (navigation_pane_filter_func):
	Only test prefix when UPNP_ROOT is set.
	(navigation_pane_tap_and_hold_query): Use
	signal_navigation_pane_context_menu instead of
	signal_content_pane_context_menu, stupid.

2006-09-08 Tapani Palli <tapani.palli@nokia.com>

	* hildon-fm/hildon-file-system-settings.c : added more properties for
	mmc status
	* hildon-fm/hildon-file-system-mmc.c : checks for opened cover and
	corrupted mmc (N39775, N40002)

2006-09-07  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-selection.c (tap_and_hold_query,
	content_pane_tap_and_hold_query,
	navigation_pane_tap_and_hold_query): New, to stop tap-and-hold
	animation when no handlers are connected.
	(hildon_file_selection_create_thumbnail_view,
	hildon_file_selection_create_list_view,
	hildon_file_selection_create_dir_view): Connect them to
	"tap-and-hold-query", as appropriate. (N21395)

2006-09-07  Marius Vollmer  <marius.vollmer@nokia.com>

        Released 1.9.

2006-09-07 Tapani Palli <tapani.palli@nokia.com>

	* hildon-fm/hildon-file-system-settings.c : Added new properties for
	tracking mmc status
	* hildon-fm/hildon-file-system-mmc.c : check for mmc status to give a
	proper reason in hildon_file_system_mmc_get_unavailable_reason()
	(N37947)

2006-09-06  Marius Vollmer  <marius.vollmer@nokia.com>

	Released 1.8.
	
	* hildon-fm/hildon-file-system-settings.c (BANNER_TIMEOUT):
	Reduced to 500 ms so that it is smaller than the initial delay of
	showing the banner.  There needs to be more theory for determining
	the 'right' timeout.
	(banner_pid): New, to store a permanent pid in the face of Linux'
	per-thread-pids.
	(_hildon_file_system_prepare_banner): Initialize it when needed
	and use it instead of getpid() in the D-Bus message.
	(_hildon_file_system_cancel_banner): Likewise. (N39738)

2006-09-06  Fernando Herrera  <fernando.herrera-de-las-heras@nokia.com>

	* hildon-fm/hildon-file-selection.c: (navigation_pane_filter_func),
	(hildon_file_selection_set_property),
	(hildon_file_selection_get_property),
	(hildon_file_selection_class_init): added a new property: "show_upnp"
	* hildon-fm/hildon-file-chooser-dialog.c:
	* hildon-fm/hildon-file-chooser-dialog.h: Added two new APIs
	functions: hildon_file_chooser_dialog_set_show_upnp / 
	hildon_file_chooser_dialog_get_show_upnp to show or not UPNP
	locations. (Part of N35160)

2006-09-05  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-system-model.c (node_needs_reload): New,
	factored out of hildon_file_system_model_delayed_add_children.
	(hildon_file_system_model_delayed_add_children): Use it.  Call
	handle_possibly_finished_node when the reload request is ignored
	so that the "finished-loading" signal is emitted for every node
	that enters the reload queue. (N31278, N38652)
	(_hildon_file_system_model_queue_reload): Use it to reject
	unneeded reloads.

2006-09-04  Marius Vollmer  <marius.vollmer@nokia.com>

	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_finalize): Removed semicolon after 'if'
	condition. (N34414)
	(hildon_file_system_model_autoname_uri): Initialize "folder" to
	NULL. (N34414)

2006-08-31  Kimmo H√§m√§l√§inen  <kimmo.hamalainen@nokia.com>

	* hildon-file-system-model.c (link_file_folder): Added signal
        block/unblock to protect against unwanted "files-added" signal.
	(my_copy_deep): Changed the order in which the folders are linked. 

	* hildon-file-selection.c (on_drag_data_received): Changed to use    
        gtk_tree_view_get_dest_row_at_pos instead of old 
        gtk_tree_view_get_path_at_pos.

        Other changes as well -- check the diff.

2006-02-14  Luc Pionchon  <luc.pionchon@nokia.com>

	Moved hildon-file-details-dialog from hildon-libs to hildon-fm.
        Merged hildon-lgpl into hildon-libs.

	* hildon-fm/hildon-file-details-dialog.[ch]: added from hildon-libs

	* hildon-fm/Makefile.am : added reference to
	hildon-file-details-dialog.[ch]

	* configure.ac (PKG_CHECK_MODULES): removes dependency on
	hildon-lgpl. Depends on hildon-libs 0.12.0


2006-02-13  Murray Cumming  <murrayc@murrayc.com>

	* hildon-fm/hildon-file-system-model.h: 
	Use a prototype declaration for HildonFileSystemModel, 
	as with other structs, so that the C++ bindings can hide the 
	full implementation from their headers.

2006-01-12  Luc Pionchon  <luc.pionchon@nokia.com>

	N#19820 Memory leaks in the file selector dialog and underlying components
	* hildon-fm/hildon-file-system-model.c
	(_HildonFileSystemModelPrivate): added signal_handler_id table
	(hildon_file_system_model_finalize): use _disconnect instead of
	_disconnect_by_func, which does not release memory early enough.
	(hildon_file_system_model_constructor): Save signal IDs. We need
	those when we release signal handlers at finalize.

2006-01-12  Luc Pionchon  <luc.pionchon@nokia.com>

	Branched for maintenance (0.9.x) based on 0.9.47-1
	Developement on trunk (0.10.x)

2005-12-21  Johan Bilien <johan.bilien@nokia.com>

	* configure.ac: 0.10.0

	* Port to dbus >= 0.50

2005-11-08  Luc Pionchon  <luc.pionchon@nokia.com>

	* configure.ac: 0.9.47

2005-11-08  Luc Pionchon  <luc.pionchon@nokia.com>

	* hildon-fm/hildon-file-selection.c (MAX_CURSOR_PARTS)
	(drag_begin): Added upper limit to number of items in the drag
	cursor. N#20202.

2005-11-03  Luc Pionchon  <luc.pionchon@nokia.com>

	* configure.ac: 0.9.46

	N#20755 Modifications to GtkTreeModels cause File selector to load
                much more content than intended.

	* hildon-fm/hildon-file-system-model.c
	(*): Removed in_timeout member. The need for that was dissapeared.
	
	(hildon_file_system_model_ref_node),
	(hildon_file_system_model_unref_node),
	(node_is_under_removable): functions removed
	
	(set_mmc_state): Changed to avoid possible extra reload in save
	dialogs.
	
	(hildon_file_system_model_iter_n_children): Removed node loading.

	(hildon_file_system_model_get_value): Changed to load children
	when a field that is needed to display folder graphically is
	requested.

	(hildon_file_system_model_delayed_add_children): Changed to skip
	extra reloads on MMC at some cases.

	
2005-10-31  Luc Pionchon  <luc.pionchon@nokia.com>

	* configure.ac: 0.9.45

2005-10-31  Luc Pionchon  <luc.pionchon@nokia.com>

	N#20341 hildon_file_system_model_autoname_uri doesn't work
	        properly for names having numbers.

	* hildon-file-system-private.[ch]:
	(_hildon_file_system_parse_autonumber): Moved parse_autonumber
	here from hildon-file-system-model.c, with following changes:
	Changed all error cases immediately return -1 (not accepted) and
	remove separate ACCEPT state (input is now accepted, when state
	machine is in CLOSE state at the end of input). Small logic
	changes (not increase input pointer after number conversion, since
	it already points to next character).
	
	(_hildon_file_system_remove_autonumber): Refactored from
	autoname_uri. Also needed in save dialog.
	
	* hildon-file-system-model.c: move out parse_autonumber(). Use new
	_hildon_file_system_parse_autonumber instead.

	* hildon-file-chooser-dialog.c
	(hildon_file_chooser_dialog_set_current_name): Changed to remove
	existing autonumber from name, if autonumbering is enabled.
	
2005-10-05  Luc Pionchon  <luc.pionchon@nokia.com>

	* configure.ac: 0.9.44

2005-10-05  Luc Pionchon  <luc.pionchon@nokia.com>

        N#19698 File dialog doesn't free everything it has allocated/cached
	
	* hildon-fm/hildon-file-system-private.c: Changed the cache to use
	weak references instead of normal hard references. Chnaged the
	whole cache object to be destroyed as well, when it temporarily
	becomes empty.
	
	(load_icon_cached): Reference changes due to above logic change.
	(insert_icon): Added weak reference.
	(get_cache): Changed to use new finalizer function.
	(icon_finalized): New function, called when a cached icon is freed.
	(cache_finalize): New function, called when the whole cache
	becomes empty or icon theme dies.

	* hildon-fm/hildon-file-system-model: Changed to keep hard
	reference to emblems, because cache modifications would otherwise
	cause emblems to be reloaded for each composite icon made.

	(finalize): Unref emblems
	(create_composite_image): Changed to take emblem icon as
	parameter, not just name.
	(get_collapsed_emblem): New function, ensures that emblem is
	cached
	(get_expanded_emblem): New function, ensures that emblem is cached

2005-10-05  Luc Pionchon  <luc.pionchon@nokia.com>

	* configure.ac: 0.9.43

2005-10-05  Luc Pionchon  <luc.pionchon@nokia.com>

	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_finalize): Now removing signal handlers
	that are bound to a longliving object. N#19820

2005-10-04  Luc Pionchon  <luc.pionchon@nokia.com>

	* hildon-fm/hildon-file-chooser-dialog.c: 
        - removed automatical name entry selection after model has
          finished loading.
        - autonaming now selects the generated file name only if the user
          hasn't moved the cursor yet; otherwise the new cursor location
          is preserved.
          N#19311

2005-09-26  Luc Pionchon  <luc.pionchon@nokia.com>

	* configure.ac: 0.9.42

	N#16169 File dialog shows "Updating" for several minutes although
	directory doesn't have any files matching the mime-type requested
	by the application (but 100 others):
	
	* hildon-fm/hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_ensure_idle):
	hildon_file_selection_model_delayed_add_node_list_timeout idle
	handler priority lowered
	(hildon_file_system_model_delayed_add_node_list): model is now
	constructed breadth-first, not depth-first
	(_hildon_file_system_model_prioritize_folder): function added for
	moving a folder to the head of delayed_lists queue
	
	* hildon-fm/hildon-fm/hildon-file-system-model.h: added prototype
	for _hildon_file_system_model_prioritize_folder

	* hildon-fm/hildon-fm/hildon-file-selection.c
	(hildon_file_selection_selection_changed): now calls
	_hildon_file_system_model_prioritize_folder when the folder is
	changed.

2005-09-15  Luc Pionchon  <luc.pionchon@nokia.com>

	* configure.ac: 0.9.41

2005-09-15  Kristian Rietveld  <kris@imendio.com>

	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_kick_node): first emit the row_deleted
	signal, than actually delete the node from the tree. (the
	row_deleted signal can trigger unrefs for this node, which still
	need to be handled). N#17314

2005-09-14  Luc Pionchon  <luc.pionchon@nokia.com>

	* hildon-fm/hildon-file-system-private.c
	(_hildon_file_system_create_file_name): Remove trailing spaces
	from MMC name. N#17823
	
2005-09-14  Luc Pionchon  <luc.pionchon@nokia.com>

	* configure.ac: 0.9.40

2005-09-13  Luc Pionchon  <luc.pionchon@nokia.com>

	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_constructor): fixed memory leak. Removed
	local_device_path from private data struct, use local
	variable. N#19145

2005-09-09  Luc Pionchon  <luc.pionchon@nokia.com>

	* configure.ac: 0.9.39

2005-09-09  Luc Pionchon  <luc.pionchon@nokia.com>

	N#14586 Gateway content needs update if
	   1) user clicks on a folder AND more than 30s is passed from
	   last reload.
	   2) User activates a filewithin current folder and than 30s is
	   passed from last reload.
	
	* hildon-fm/hildon-file-selection.c
	(hildon_file_selection_selection_changed): reload gateway content.

	* hildon-fm/hildon-file-system-model.c
	(_hildon_file_system_model_queue_reload): likewise.


2005-09-08  Luc Pionchon  <luc.pionchon@nokia.com>

	* configure.ac: Release 0.9.38
	
2005-09-09  Luc Pionchon  <luc.pionchon@nokia.com>

	N#16092 Filetree doesn't use singleton mime-type icons, but keeps
	multiple copies of them in memory.
	
	* hildon-fm/hildon-file-system-private.[ch]
	(_hildon_file_system_load_icon_cached): New function that
	implements caching.
	(_hildon_file_system_create_image): now uses cache when loading
	icons.

	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_create_composite_image): now uses cache
	when loading icons.

	

        N#18253 Phone icon is not dimmed (in file tree) when the phone
	does not support OBEX.
	
	* hildon-fm/hildon-file-system-settings.c (gateway-ftp): added new
	property "gateway-ftp".
	(_hildon_file_system_settings_get_flight_mode): Added ftp capability check.

	* hildon-fm/hildon-file-selection.c
	(hildon_file_selection_real_row_insensitive): Added a check if
	gateway is dimmed because of missing ftp capability.


2005-09-08  Luc Pionchon  <luc.pionchon@nokia.com>

	* configure.ac: Release 0.9.37

2005-09-07  Luc Pionchon  <luc.pionchon@nokia.com>

	Some GTK filesystem backend cause blocking for unknown amount of
	time. We "solve" this (give feedback to the user) by adding a dbus
	service to TN to display an "updating" info banner after one
	second.
	
	* hildon-file-system-settings.h: Introduced new internal API to
	communicate with task navigator in order to display banner during
	blocking backend operations.

	* hildon-file-system-settings.c: Implemented new communication API.

	* hildon-file-system-model.c:
	- Added calls to task navigator to show banner during blocking
	calls.
	
	- Changed nodes that need to be reloaded to be queued instead of
	the old approach where error nodes were queued. In this way we can
	remove problem nodes from model immediately after error condition
	is detected.
	
2005-09-07  Luc Pionchon  <luc.pionchon@nokia.com>
	
	* hildon-file-system-model.c: Added handler for new
	GtkFileSystemError code. This causes less calls over bluetooth.	

2005-08-30  Tommi Komulainen  <tommi.komulainen@nokia.com>

	* configure.ac: Release 0.9.36

2005-08-30  Tommi Komulainen  <tommi.komulainen@nokia.com>

	* hildon-fm/hildon-file-system-model.c: Added a priority queue to
	track most frequently used nodes and remove oldest items if needed, to
	limit memory consumption.
	N#16151

2005-08-22  Tommi Komulainen  <tommi.komulainen@nokia.com>

	* configure.ac: Release 0.9.35

2005-08-22  Tommi Komulainen  <tommi.komulainen@nokia.com>

	* hildon-fm/hildon-file-system-model.c: (get_value) In some cases
	gateway folder became dimmed because of read error. 
	* (handle_delayed_error) It was possible that the whole gateway root
	folder got deleted.
	* (delayed_add_children) gtk_file_system_folder_list_children
	succeeds, even in a case bt is switched off. Made a workaround for
	this.
	* Some code cleanup (handle_delayed_error, set_mmc_state,
	flightmode_changed).
	* Added implementation for the new signal and protection mechanism to
	avoid several reloads from gateway when there is no connection.

	* hildon-fm/hildon-file-system-model.h: Added new
	"device-disconnected" signal.

	* hildon-fm/hildon-file-selection.c: Added handler for the new signal.
	* (selection_changed) We now return current folder back to it's
	previous place if we fail to connect to gateway device.
	* changed "to_be_selected" row reference into "current_folder", which
	keeps eye on current folder all the time. This change was needed to
	know previous folder. This causes many small changes here and there.

	N#14585, N#14586

2005-08-17  Tommi Komulainen  <tommi.komulainen@nokia.com>

	* configure.ac: Release 0.9.34
	
2005-08-17  Tommi Komulainen  <tommi.komulainen@nokia.com>

	* hildon-fm/hildon-file-system-private.c
	(_hildon_file_system_create_file_name): 
	Take special 'mmc-undefined-name' name for unnamed MMCs into account
	when resolving device names.  N#15509

2005-08-17  Tommi Komulainen  <tommi.komulainen@nokia.com>

	* configure.ac: Release 0.9.33
	
2005-08-16  Tommi Komulainen  <tommi.komulainen@nokia.com>

	* hildon-fm/hildon-file-system-private.c (locations):
	* po/en_GB.po: s/sfil_li_mmc_local_device/sfil_li_mmc_localdevice/
	
2005-08-16  Tommi Komulainen  <tommi.komulainen@nokia.com>

	* hildon-fm/hildon-file-selection.h
	* hildon-fm/hildon-file-selection.c
	(hildon_file_selection_clear_multi_selection): New function that only
	clears other selections, but keeps the item with (active/passive)
	focus selected.
	* hildon-fm/hildon-file-selection.c
	(hildon_file_selection_unselect_all): Now really unselects all paths,
	also active/passive focus. 
	N#15806

2005-08-16  Tommi Komulainen  <tommi.komulainen@nokia.com>

	* hildon-fm/hildon-file-system-model.c
	(hildon_file_system_model_add_node): Block file system backend from
	sending a signal just when the same node is being added to internal
	data model, which causes that the internal data model believes that it
	has already loaded the folder.
	N#14040

2005-08-16  Tommi Komulainen  <tommi.komulainen@nokia.com>

	Update to new l10n packaging style.  po-files (inside this package)
	are not used for now, the message catalogs come from separate packages
	and including them here would conflict.

	* Makefile.am (SUBDIRS): stop including po-files
	* Makefile.am (EXTRA_DIST):
	* debian/hildon-fm-l10n-engb.install:
	* debian/hildon-fm-l10n-src.install:
	* po/debian/*: Removed

2005-08-10  Luc Pionchon  <luc.pionchon@nokia.com>

	* hildon-fm/hildon-file-chooser-dialog.c (handle_folder_popup):
	use logical string for message for generic error. N#13795
	* po/en_GB.po: added sfil_ni_operation_failed translation
	
	* hildon-fm/hildon-file-system-info.[ch]:
	(hildon_file_system_info_get_icon_at_size) Added new interface to
	get an icon in arbitrary size. N#16986

2005-08-09  Luc Pionchon  <luc.pionchon@nokia.com>

	* hildon-fm/hildon-file-system-model.c: Now MMC state is
	investigated immediately when the widget is created. It makes the
	creation to take a bit more time, but ensures that MMC locations
	are usable as well right from the start.

	* hildon-fm/hildon-file-chooser-dialog.c: Allow setting limit to
	the filename. Added two new properties:

	- "max-full-path-length": Works as current limitation system, but
	you can now change the value as well (if needed, defaults to 255)

	- "max-name-length": Limits the length of individual file/folder
	name as entered by user (note that possible hidden
	extension/folder path make the name longer).

2005-08-03  Luc Pionchon  <luc.pionchon@nokia.com>

	* hildon-fm/hildon-file-chooser-dialog.c
	(hildon_file_chooser_dialog_get_paths): remove leading dots from
	user provided file names (otherwise files are be hidden by the
	filemanager, and the user has no way to access them.)

2005-08-01  Luc Pionchon  <luc.pionchon@nokia.com>

	* hildon-file-selection.c: GtkTreeModelSort didn't keep
	the order very well for equal nodes, therefore a sort 
	function was fixed to handle device nodes correctly.
	
	* hildon-file-system-model.c: Now allowing load_uri to access
	gateway before gateway is accessed by UI.

	* hildon-file-system-settings.[ch]: Added
	_hildon_file_system_settings_ready() for checking if all settings
	have been loaded.

2005-07-26  Luc Pionchon  <luc.pionchon@nokia.com>

	* hildon-fm/hildon-file-system-settings.c (hildon_file_system_settings_setup_dbus): changed pending dbus calls to use default timeout value (which is longer than our old value).

	* hildon-fm/hildon-file-system-model.c : 
	  - Fixed a race condition from volumes-changed handler
	    (not queued to idle anymore).
	  - Restored call to delayed_add_children that was removed earlier.
            Added one new call to this function to set_mmc_state as well
	    (to make mmc immediately show '+' sign if needed).
	
2005-07-25  Luc Pionchon <luc.pionchon@nokia.com>

	* hildon-file-system-settings.c: Added auto activation flags into dbus
	requests

	* hildon-file-selection.c: 
	Added infoprint
	Fixed navigation pane filtering
	Fixed automatic location change

	* en_GB.po: Fixed a typo from translations

	* hildon-file-system-model.c:
	Added checking for readability
	Implemented node referencing support
	Fixed removing of folder objects
	Fixed a problem with uri vs. display text encodings

	* hildon-file-selection.h:
	* hildon-file-chooser-dialog.c:
	Fixed automatic location change

	Fixed File Selection widget folder names

	Fixed dimming for unreadable files in FileSelectionWidget

	Fixed inconsistent drag and drop behaviour in multiple selection for
	FileSelectionWidget

	Fixed inconsistent behaviour of hildon_file_system_model_autoname_uri

	Fixed notes files not opened after duplicating

	Fixed 'autoname_uri' that didn't work properly for files with double
	extensions

	Fixed Control Panel that crashed on exporting certificate to MMC & the
	MMC cover is open

	Fixed HildonFileChooserDialog that didn't implement
	gtk_filechooser_set_local_only

	Drag data is now stored when drag begins to prevent GtkTreeVIew from
	clearing selection due to button-release event before drag-data-get
	signal is received
